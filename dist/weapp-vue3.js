!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self)["weapp-vue3"]=e["weapp-vue3"]||{},e["weapp-vue3"].js={}))}(this,function(e){"use strict";const s=new WeakMap;let u;const o=[],c=Symbol(),i=Symbol(),n=new Map;let a=!0;const f={};function l(n,e={}){const r=()=>{var t=r;for(let e=0;e<t.deps.length;e++)t.deps[e].delete(t);t.deps.length=0,u=r,o.push(r);var e=n();return o.pop(),u=o[o.length-1],e};return r.options=e,r.deps=[],e.lazy||r(),r}function p(n,r){if(u&&a){let e=s.get(n),t=(e||s.set(n,e=new Map),e.get(r));t||e.set(r,t=new Set),t.add(u),u.deps.push(t)}}function d(e,t,n,r){var o=s.get(e);if(o){var a=o.get(t);o.get(c);const f=new Set;a&&a.forEach(e=>{e!==u&&f.add(e)}),"ADD"===n&&Array.isArray(e)&&(a=o.get("length"))&&a.forEach(e=>{e!==u&&f.add(e)}),Array.isArray(e)&&"length"===t&&o.forEach((e,t)=>{r<=t&&e.forEach(e=>{e!==u&&f.add(e)})}),"ADD"!==n&&"DELETE"!==n&&"[object Map]"!==Object.prototype.toString.call(e)||(a=o.get(i))&&a.forEach(e=>{e!==u&&f.add(e)}),f.forEach(e=>{e.options&&e.options.scheduler?e.options.scheduler(e):e()})}}function t(e,t,n={}){let r;r="function"==typeof e?e:()=>function e(t,n=new Set){if("object"==typeof t&&null!==t&&!n.has(t)){n.add(t);for(const r in t)e(t[r],n);return t}}(e);let o,a,f;function s(e){f=e}const u=()=>{a=R(c()),f&&f(),t(a,o,s),o=a},c=l(()=>r(),{lazy:!0,scheduler:()=>{"post"===n.flush?(new Promise.resolve).then(u):u()}});n.immediate?u():o=R(c())}function r(e,r=!1,s=!1){return new Proxy(e,{get(e,t,n){if("raw"===t)return e;if("size"===t)return p(e,c),Reflect.get(e,t,e);if(Array.isArray(e)&&f.hasOwnProperty(t))return Reflect.get(f,t,n);s||"symbol"==typeof t||p(e,t);e=Reflect.get(e,t,n);return!r&&"object"==typeof e&&null!==e?(s?h:y)(e):e},set(e,t,n,r){var o,a,f;return s?(console.warn(`属性 ${t} 只读，不能被修改`),!0):(o=e[t],a=Array.isArray(e)?Number(t)<e.length?"SET":"ADD":Object.prototype.hasOwnProperty.call(e,t)?"SET":"ADD",f=Reflect.set(e,t,n,r),e!==r.raw||o===n||o!=o&&n!=n||d(e,t,a,n),f)},deleteProperty(e,t){var n,r;return s?(console.warn(`属性 ${t} 只读，不能被删除`),!0):(n=Object.prototype.hasOwnProperty.call(e,t),(r=Reflect.deleteProperty(e,t))&&n&&d(e,t,"DELETE"),r)},ownKeys(e){return p(e,Array.isArray(e)?"length":c),Reflect.ownKeys(e)}})}function y(e){var t=n.get(e);return t||(t=r(e),n.set(e,t),t)}function h(e){return r(e,!1,!0)}function v(e){return!!e.__v_isRef}function R(e){return v(e)?e.value:e}function w(e){return new Proxy(e,{get(e,t,n){return R(Reflect.get(e,t,n))},set(e,t,n,r){return v(e[t])&&!v(n)?e[t].value=n:Reflect.set(e,t,n,r)}})}function g(o,e){t(w(e()),(e,t)=>{{const{fields:n,methods:r}=(e=>{var t={},n={};for(const r in e)"function"==typeof e[r]?n[r]=e[r]:t[r]=e[r];return{fields:t,methods:n}})(e);Object.keys(r).forEach(e=>{o[e]=r[e]}),o.setData(n)}},{immediate:!0})}["includes","indexof","lastIndexOf"].forEach(e=>{const n=Array.prototype[e];f[e]=function(...e){let t=n.apply(this,e);return t=!1!==t&&-1!==t?t:n.apply(this.raw,e)}}),["push","pop","shift","unshift","splice"].forEach(e=>{const t=Array.prototype[e];f[e]=function(...e){a=!1;e=t.apply(this,e);return a=!0,e}});var m={effect:l,ref:function(e){return e={value:e},Object.defineProperty(e,"__v_isRef",{value:!0}),y(e)},isRef:v,unRef:R,proxyRefs:w,reactive:y,readonly:h,shallowReactive:function(e){return r(e,!0,!0)},toRefs:function(e){var t={};for(const n in e)t[n]=function(t,n){var e={get value(){return t[n]},set value(e){t[n]=e}};return Object.defineProperty(e,"__v_isRef",{value:!0}),e}(e,n);return t},isReactive:function(e){return!(!e||!e.__v_isRef)},toRaw:function(e){return e.raw||e},watch:t,computed:function(e){let t,n=!0;const r=l(e,{lazy:!0,scheduler:()=>{n=!0,d(o,"value")}}),o={__v_isRef:!0,get value(){return n&&(t=r(),n=!1),u&&p(o,"value"),t}};return o},Page:function(e){Page({onLoad(){g(this,e)}})},Component:function(t){let n={};var r;"function"!=typeof t&&(n=t.props,t=t.setup),Component({behaviors:[],properties:(r=n,Object.keys(r).reduce((e,t)=>(e[t]=r[t].default?{type:r[t].type,value:r[t].default}:r[t],e),{})),data:{},lifetimes:{created(){},attached(){o=this,e=n;var o,e=new Proxy(e,{get(e,t,n){let r=o.data[t];return r=void 0===r?e[t].default:r},set:function(e,t,n,r){return o.setData({[t]:n}),Reflect.set(e,t,n,r)}});g(this,t.bind(null,e))},moved(){},detached(){}},methods:{}})}},b=m.effect,E=m.ref,_=m.isRef,A=m.unRef,P=m.proxyRefs,j=m.reactive,D=m.readonly,O=m.shallowReactive,x=m.toRefs,S=m.isReactive,T=m.toRaw,M=m.watch,z=m.computed,C=m.Page;e.Component=m.Component,e.Page=C,e.computed=z,e.default=m,e.effect=b,e.isReactive=S,e.isRef=_,e.proxyRefs=P,e.reactive=j,e.readonly=D,e.ref=E,e.shallowReactive=O,e.toRaw=T,e.toRefs=x,e.unRef=A,e.watch=M,Object.defineProperty(e,"__esModule",{value:!0})});
